**Script *local_metrics***

The script allows you to calculate local spatial metrics that measure the shooting efficiency of players in individual cells in relation to the league average. 
To run the script, you must have a layer in SHP format with the estimated league PPA value obtained in the previous *empirical_bayes.py* script (e.g., the *EB.shp* file).

**Input parameters for the program** 

For the program to work correctly, the following input parameters must be entered in the following order:

- path to the subdirectory with SHP files for individual players, defined in script No. 1 *data_collection.py* (e.g., *C:/Users/Desktop/output/players*),

- path to the file with the EB estimate, specified in script No. 2 *empirical_bayes.py* (e.g., *C:/Users/Desktop/output/EB.shp*),

- path to the output folder (e.g., *C:/Users/Desktop/output/local_metrics*).

**Example script call**

*“C:/Users/Desktop/output/players”, “C:/Users/Desktop/output/EB.shp”, “C:/Users/Desktop/output/local_metrics”*

**Program output**

Output files in CSV and SHP formats are saved in the output folder defined when entering the input parameters (e.g., *C:/Users/Desktop/output/local_metrics*). 
For each player, local spatial metric values are calculated, such as Expected Local Points (*ELPTS* column), Local Points per Attempt (*LPPA*), Local Spatial Scoring Effectiveness (*LSScE*), 
and Local Points Relative to League Average (*LPRLA*). 
SHP files can be imported into GIS software and visualized, while CSV files will be used in script No. 4 (*global_metrics.py*) to calculate global metrics.

**Visualization of output data**

The output file in SHP format can be opened in GIS software and then visualized. To do this, you need to:

- load the output file generated by the script into GIS software (*Layer* -> *Add Layer* -> *Add Vector Layer*)

- convert the file into a point layer using the *Centroid* tool. To do this, in the QGIS main menu, search for *Vector* -> *Geometry Tools* -> *Centroid*

- right-click on the name of the layer in the list of open layers, then go to *Properties* -> *Symbology* -> *Single Symbol* -> *Size*.
To the right of the size field, there is a button with a drop-down menu icon (*Data-defined Override*).
To visualize the layer depending on the number of attempts from a given cell, select *Assistant* -> *Source* and select the FGA column, then adjust the values and sizes.

- At the same time, you can visualize the data depending on the value of the selected spatial shooting metrics. 
To do this, go to *Style* and switch from *Single symbol* to *Graduated*

- In the *Value* field, select the column with the selected shooting efficiency metric and select the number of classes (*Classes*). 
It is recommended to use four to six class intervals in order to effectively distinguish between different efficiency zones. 
Class intervals can be defined using the Jenks method (*Mode* -> *Natural breaks (Jenks)* -> *Classify*). The color scale can be selected using the *Color Ramp* tool located
above the class intervals. It is recommended to visualize negative values with “cold” colors and positive values with “warm” colors.
